var paymentSign="$";function otherPayment(){var e=document.getElementById("choices-payment-currency").value;paymentSign=e,document.getElementsByClassName("product-line-price").forEach((function(e){isUpdate=e.value.slice(1),e.value=paymentSign+isUpdate})),recalculateCart()}document.getElementsByClassName("product-line-price").forEach((function(e){e.value=paymentSign+"0.00"}));var isPaymentEl=document.getElementById("choices-payment-currency"),choices=new Choices(isPaymentEl,{searchEnabled:!1});function isData(){var e=document.getElementsByClassName("plus"),t=document.getElementsByClassName("minus");e&&e.forEach((function(e){e.onclick=function(t){if(parseInt(e.previousElementSibling.value)<10){t.target.previousElementSibling.value++;var n=e.parentElement.parentElement.previousElementSibling.querySelector(".product-price").value,o=e.parentElement.parentElement.nextElementSibling.querySelector(".product-line-price");updateQuantity(e.parentElement.querySelector(".product-quantity").value,n,o)}}})),t&&t.forEach((function(e){e.onclick=function(t){if(parseInt(e.nextElementSibling.value)>1){t.target.nextElementSibling.value--;var n=e.parentElement.parentElement.previousElementSibling.querySelector(".product-price").value,o=e.parentElement.parentElement.nextElementSibling.querySelector(".product-line-price");updateQuantity(e.parentElement.querySelector(".product-quantity").value,n,o)}}}))}document.querySelector("#profile-img-file-input").addEventListener("change",(function(){var e=document.querySelector(".user-profile-image"),t=document.querySelector(".profile-img-file-input").files[0],n=new FileReader;n.addEventListener("load",(function(){e.src=n.result}),!1),t&&n.readAsDataURL(t)})),flatpickr("#date-field",{enableTime:!0,dateFormat:"d M, Y, h:i K"}),isData();var count=1;function new_link(){count++;var e=document.createElement("tr");e.id=count,e.className="product";var t='<tr><th scope="row" class="product-id">'+count+'</th><td class="text-start"><div class="mb-2"><input class="form-control bg-light border-0" type="text" id="productName-'+count+'" placeholder="Product Name"></div><textarea class="form-control bg-light border-0" id="productDetails-'+count+'" rows="2" placeholder="Product Details"></textarea></div></td><td><input class="form-control bg-light border-0 product-price" type="number" id="productRate-'+count+'" step="0.01" placeholder="$0.00"></td><td><div class="input-step"><button type="button" class="minus">â€“</button><input type="number" class="product-quantity" id="product-qty-'+count+'" value="0" readonly><button type="button" class="plus">+</button></div></td><td class="text-end"><div><input type="text" class="form-control bg-light border-0 product-line-price" id="productPrice-'+count+'" value="$0.00" placeholder="$0.00" /></div></td><td class="product-removal"><a class="btn btn-success">Delete</a></td></tr>';e.innerHTML=document.getElementById("newForm").innerHTML+t,document.getElementById("newlink").appendChild(e),document.querySelectorAll("[data-trigger]").forEach((function(e){new Choices(e,{placeholderValue:"This is a placeholder set in the config",searchPlaceholderValue:"This is a search placeholder"})})),isData(),remove(),amountKeyup(),resetRow()}remove();var taxRate=.125,shippingRate=65,discountRate=.15;function remove(){document.querySelectorAll(".product-removal a").forEach((function(e){e.addEventListener("click",(function(e){removeItem(e),resetRow()}))}))}function resetRow(){document.getElementById("newlink").querySelectorAll("tr").forEach((function(e,t){var n=t+1;e.querySelector(".product-id").innerHTML=n}))}function recalculateCart(){var e=0;document.getElementsByClassName("product").forEach((function(t){t.getElementsByClassName("product-line-price").forEach((function(t){t.value&&(e+=parseFloat(t.value.slice(1)))}))}));var t=e*taxRate,n=e*discountRate,o=e>0?shippingRate:0,a=e+t+o-n;document.getElementById("cart-subtotal").value=paymentSign+e.toFixed(2),document.getElementById("cart-tax").value=paymentSign+t.toFixed(2),document.getElementById("cart-shipping").value=paymentSign+o.toFixed(2),document.getElementById("cart-total").value=paymentSign+a.toFixed(2),document.getElementById("cart-discount").value=paymentSign+n.toFixed(2),document.getElementById("totalamountInput").value=paymentSign+a.toFixed(2),document.getElementById("amountTotalPay").value=paymentSign+a.toFixed(2)}function amountKeyup(){document.getElementsByClassName("product-price").forEach((function(e){e.addEventListener("keyup",(function(t){var n=e.parentElement.nextElementSibling.nextElementSibling.querySelector(".product-line-price");updateQuantity(t.target.value,e.parentElement.nextElementSibling.querySelector(".product-quantity").value,n)}))}))}function updateQuantity(e,t,n){var o=e*t;o=o.toFixed(2),n.value=paymentSign+o,recalculateCart()}function removeItem(e){e.target.closest("tr").remove(),recalculateCart()}function billingFunction(){document.getElementById("same").checked?(document.getElementById("shippingName").value=document.getElementById("billingName").value,document.getElementById("shippingAddress").value=document.getElementById("billingAddress").value,document.getElementById("shippingPhoneno").value=document.getElementById("billingPhoneno").value,document.getElementById("shippingTaxno").value=document.getElementById("billingTaxno").value):(document.getElementById("shippingName").value="",document.getElementById("shippingAddress").value="",document.getElementById("shippingPhoneno").value="",document.getElementById("shippingTaxno").value="")}amountKeyup(),(genericExamples=document.querySelectorAll("[data-trigger]")).forEach((function(e){new Choices(e,{placeholderValue:"This is a placeholder set in the config",searchPlaceholderValue:"This is a search placeholder"})}));var genericExamples,cleaveBlocks=new Cleave("#cardNumber",{blocks:[4,4,4,4],uppercase:!0});let viewobj;(genericExamples=document.querySelectorAll('[data-plugin="cleave-phone"]')).forEach((function(e){new Cleave(e,{delimiters:["(",")","-"],blocks:[0,3,3,4]})}));var invoices_list=localStorage.getItem("invoices-list"),options=localStorage.getItem("option"),invoice_no=localStorage.getItem("invoice_no"),invoices=JSON.parse(invoices_list);if(null===localStorage.getItem("invoice_no")&&null===localStorage.getItem("option")){viewobj="";var value="#VL"+Math.floor(11111111+99999999*Math.random());document.getElementById("invoicenoInput").value=value}else viewobj=invoices.find((e=>e.invoice_no===invoice_no));if(""!=viewobj&&"edit-invoice"==options){document.getElementById("registrationNumber").value=viewobj.company_details.legal_registration_no,document.getElementById("companyEmail").value=viewobj.company_details.email,document.getElementById("companyWebsite").value=viewobj.company_details.website,new Cleave("#compnayContactno",{prefix:viewobj.company_details.contact_no,delimiters:["(",")","-"],blocks:[0,3,3,4]}),document.getElementById("companyAddress").value=viewobj.company_details.address,document.getElementById("companyaddpostalcode").value=viewobj.company_details.zip_code;var preview=document.querySelectorAll(".user-profile-image");""!==viewobj.img&&(preview.src=viewobj.img),document.getElementById("invoicenoInput").value="#VAL"+viewobj.invoice_no,document.getElementById("invoicenoInput").setAttribute("readonly",!0),document.getElementById("date-field").value=viewobj.date,document.getElementById("choices-payment-status").value=viewobj.status,document.getElementById("totalamountInput").value="$"+viewobj.order_summary.total_amount,document.getElementById("billingName").value=viewobj.billing_address.full_name,document.getElementById("billingAddress").value=viewobj.billing_address.address,new Cleave("#billingPhoneno",{prefix:viewobj.company_details.contact_no,delimiters:["(",")","-"],blocks:[0,3,3,4]}),document.getElementById("billingTaxno").value=viewobj.billing_address.tax,document.getElementById("shippingName").value=viewobj.shipping_address.full_name,document.getElementById("shippingAddress").value=viewobj.shipping_address.address,new Cleave("#shippingPhoneno",{prefix:viewobj.company_details.contact_no,delimiters:["(",")","-"],blocks:[0,3,3,4]}),document.getElementById("shippingTaxno").value=viewobj.billing_address.tax;var paroducts_list=viewobj.prducts,counter=1;do{counter++,paroducts_list.length>1&&document.getElementById("add-item").click()}while(paroducts_list.length-1>=counter);var counter_1=1;setTimeout((()=>{paroducts_list.forEach((function(e){document.getElementById("productName-"+counter_1).value=e.product_name,document.getElementById("productDetails-"+counter_1).value=e.product_details,document.getElementById("productRate-"+counter_1).value=e.rates,document.getElementById("product-qty-"+counter_1).value=e.quantity,document.getElementById("productPrice-"+counter_1).value="$"+e.rates*e.quantity,counter_1++}))}),300),document.getElementById("cart-subtotal").value="$"+viewobj.order_summary.sub_total,document.getElementById("cart-tax").value="$"+viewobj.order_summary.estimated_tex,document.getElementById("cart-discount").value="$"+viewobj.order_summary.discount,document.getElementById("cart-shipping").value="$"+viewobj.order_summary.shipping_charge,document.getElementById("cart-total").value="$"+viewobj.order_summary.total_amount,document.getElementById("choices-payment-type").value=viewobj.payment_details.payment_method,document.getElementById("cardholderName").value=viewobj.payment_details.card_holder_name;var cleave=new Cleave("#cardNumber",{prefix:viewobj.payment_details.card_number,delimiter:" ",blocks:[4,4,4,4],uppercase:!0});document.getElementById("amountTotalPay").value="$"+viewobj.order_summary.total_amount,document.getElementById("exampleFormControlTextarea1").value=viewobj.notes}document.addEventListener("DOMContentLoaded",(function(){var e=document.getElementById("invoice_form");document.getElementsByClassName("needs-validation");e.addEventListener("submit",(function(t){t.preventDefault();var n=document.getElementById("invoicenoInput").value.slice(4),o=document.getElementById("companyEmail").value,a=document.getElementById("date-field").value,l=document.getElementById("totalamountInput").value.slice(1),i=document.getElementById("choices-payment-status").value,c=document.getElementById("billingName").value,d=document.getElementById("billingAddress").value,u=document.getElementById("billingPhoneno").value.replace(/[^0-9]/g,""),r=document.getElementById("billingTaxno").value,m=document.getElementById("shippingName").value,s=document.getElementById("shippingAddress").value,p=document.getElementById("shippingPhoneno").value.replace(/[^0-9]/g,""),v=document.getElementById("shippingTaxno").value,g=document.getElementById("choices-payment-type").value,y=document.getElementById("cardholderName").value,E=document.getElementById("cardNumber").value.replace(/[^0-9]/g,""),b=document.getElementById("amountTotalPay").value.slice(1),I=document.getElementById("registrationNumber").value.replace(/[^0-9]/g,""),h=document.getElementById("companyEmail").value,_=document.getElementById("companyWebsite").value,B=document.getElementById("compnayContactno").value.replace(/[^0-9]/g,""),f=document.getElementById("companyAddress").value,x=document.getElementById("companyaddpostalcode").value,w=document.getElementById("cart-subtotal").value.slice(1),S=document.getElementById("cart-tax").value.slice(1),j=document.getElementById("cart-discount").value.slice(1),q=document.getElementById("cart-shipping").value.slice(1),N=document.getElementById("cart-total").value.slice(1),C=document.getElementById("exampleFormControlTextarea1").value,T=document.getElementsByClassName("product"),P=1,k=[];if(T.forEach((e=>{var t=e.querySelector("#productName-"+P).value,n=e.querySelector("#productDetails-"+P).value,o=parseInt(e.querySelector("#productRate-"+P).value),a=parseInt(e.querySelector("#product-qty-"+P).value),l=e.querySelector("#productPrice-"+P).value.split("$"),i={product_name:t,product_details:n,rates:o,quantity:a,amount:parseInt(l[1])};k.push(i),P++})),!1===e.checkValidity())e.classList.add("was-validated");else{if("edit-invoice"==options&&invoice_no==n)objIndex=invoices.findIndex((e=>e.invoice_no==n)),invoices[objIndex].invoice_no=n,invoices[objIndex].customer=c,invoices[objIndex].img="",invoices[objIndex].email=o,invoices[objIndex].date=a,invoices[objIndex].invoice_amount=l,invoices[objIndex].status=i,invoices[objIndex].billing_address={full_name:c,address:d,phone:u,tax:r},invoices[objIndex].shipping_address={full_name:m,address:s,phone:p,tax:v},invoices[objIndex].payment_details={payment_method:g,card_holder_name:y,card_number:E,total_amount:b},invoices[objIndex].company_details={legal_registration_no:I,email:h,website:_,contact_no:B,address:f,zip_code:x},invoices[objIndex].order_summary={sub_total:w,estimated_tex:S,discount:j,shipping_charge:q,total_amount:N},invoices[objIndex].prducts=k,invoices[objIndex].notes=C,localStorage.removeItem("invoices-list"),localStorage.removeItem("option"),localStorage.removeItem("invoice_no"),localStorage.setItem("invoices-list",JSON.stringify(invoices));else{var A={invoice_no:n,customer:c,img:"",email:o,date:a,invoice_amount:l,status:i,billing_address:{full_name:c,address:d,phone:u,tax:r},shipping_address:{full_name:m,address:s,phone:p,tax:v},payment_details:{payment_method:g,card_holder_name:y,card_number:E,total_amount:b},company_details:{legal_registration_no:I,email:h,website:_,contact_no:B,address:f,zip_code:x},order_summary:{sub_total:w,estimated_tex:S,discount:j,shipping_charge:q,total_amount:N},prducts:k,notes:C};localStorage.setItem("new_data_object",JSON.stringify(A))}window.location.href="apps-invoices-list"}}))}));
