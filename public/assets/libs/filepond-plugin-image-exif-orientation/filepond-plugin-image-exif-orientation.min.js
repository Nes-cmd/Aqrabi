!function(A,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(A=A||self).FilePondPluginImageExifOrientation=e()}(this,(function(){"use strict";var A=function(A,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return A.getUint16(e,n)},e=function(A,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return A.getUint32(e,n)},n="undefined"!=typeof window&&void 0!==window.document,t=void 0,i=n?new Image:{};i.onload=function(){return t=i.naturalWidth>i.naturalHeight},i.src="data:image/jpg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/4QA6RXhpZgAATU0AKgAAAAgAAwESAAMAAAABAAYAAAEoAAMAAAABAAIAAAITAAMAAAABAAEAAAAAAAD/2wBDAP//////////////////////////////////////////////////////////////////////////////////////wAALCAABAAIBASIA/8QAJgABAAAAAAAAAAAAAAAAAAAAAxABAAAAAAAAAAAAAAAAAAAAAP/aAAgBAQAAPwBH/9k=";var r=function(n){var i=n.addFilter,r=n.utils,o=r.Type,a=r.isFile;return i("DID_LOAD_ITEM",(function(n,i){var r=i.query;return new Promise((function(i,o){var u=n.file;if(!(a(u)&&function(A){return/^image\/jpeg/.test(A.type)}(u)&&r("GET_ALLOW_IMAGE_EXIF_ORIENTATION")&&t))return i(n);(function(n){return new Promise((function(t,i){var r=new FileReader;r.onload=function(n){var i=new DataView(n.target.result);if(65496===A(i,0)){for(var r=i.byteLength,o=2;o<r;){var a=A(i,o);if(o+=2,65505===a){if(1165519206!==e(i,o+=2))break;var u=18761===A(i,o+=6);o+=e(i,o+4,u);var d=A(i,o,u);o+=2;for(var f=0;f<d;f++)if(274===A(i,o+12*f,u))return void t(A(i,o+12*f+8,u))}else{if(65280!=(65280&a))break;o+=A(i,o)}}t(-1)}else t(-1)},r.readAsArrayBuffer(n.slice(0,65536))}))})(u).then((function(A){n.setMetadata("exif",{orientation:A}),i(n)}))}))})),{options:{allowImageExifOrientation:[!0,o.BOOLEAN]}}};return"undefined"!=typeof window&&void 0!==window.document&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:r})),r}));
